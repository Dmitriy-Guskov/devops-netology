# Домашнее задание к занятию "5.2. Системы управления виртуализацией"

## Задача 1 

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

- 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований  
Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий 
- Требуется наиболее производительное бесплатное opensource решение для виртуализации небольшой (20 серверов) инфраструктуры Linux и Windows виртуальных машин
- Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры 
- Необходимо рабочее окружение для тестирование программного продукта на нескольких дистрибутивах Linux



Ответ:

1.	Раз нет особых требований, то можно выбирать все что угодно. Поскольку в условии у нас дано некоторое количество виртуалок на Windows имеет смысл рассмотреть виртуализацию на базе MS Hyper-V, считается, что гостевые виртуалки на Windows будут иметь небольшое преимущество в производительности. Так же к «плюсам» можно отнести широкий диапазон поддерживаемых устройств. VMWare vSphere тоже будет неплохо. Наиболее универсальное решение для зоопарка виртуалок (вин+никс) - сбалансированное решения обеспечивающее отличную производительность. В конечном итоге выбор решения, как всегда, упрётся в бюджет и существующую инфраструктуру (стоимость лицензий, обучение персонала и т.п.)
2.	KVM – поддерживает и win и *nix, бесплатен, производителен. XEN, вроде бы тоже подходит, но пишут, что он менее производителен, зато более стабилен. Лично не сталкивался ни с тем ни с другим. По описанию больше нравится KVM.
3.	Здесь опять выбор между KVM и Xen. Hyper-V не годится, он не бесплатен. Из-за лучшей поддержки Windows в KVM выбираем его.
4.	Выбираем VMWare Fusion, VMWare Workstation, VirtualBox. Отдаю свой голос за VMWare как наиболее стабильную и совместимую платформу.




## Задача 2

Опишите сценарий миграции с VMware vSphere на Hyper-V для Linux и Windows виртуальных машин. Детально опишите необходимые шаги для использования всех преимуществ Hyper-V для Windows.

Ответ:

* Сценарий 1. На Hyper-V создаем виртуалку и заливаем в нее бэкап требуемой системы. Достаточно удобно, если виртуалка бэкапится как сервер, а не сущность VM.
* Сценарий 2. Используем конвертер для виртуалки (у MS, кажется есть, VMM опять же - https://docs.microsoft.com/ru-ru/system-center/vmm/vm-convert-vmware?view=sc-vmm-2019). Для виртуалок на винде будет критичный момент в дисковом контроллере. Перед конвертацией меняем драйвер диска на «generic». На входе у нас диск vmdx, на выходе получаем vhdx. Далее создаем виртуалку в Hyper-V и подключаем сконвертированный диск. Запускаем.
 

Преимущество Hyper-V для Windows в первую очередь заключаются в лицензировании: если хост работает под управлением Windows Server Enterprise или Datacenter то на лицензиях можно хорошо сэкономить. Так же Hyper-V для windows обеспечивает более высокую производительность. Обеспечивает высокую доступность и отказоустойчивость при использовании кластеризации.




## Задача 3 

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был бы выбор, то создавали ли вы бы гетерогенную среду или нет? Мотивируйте ваш ответ примерами. 

Ответ:
Проблемы видятся в таком направлении:
- нужно больше инженеров (содержать несколко команд администрирования/сопровождения для разных систем);
- ниже масштабируемость;
- сложность при управлении ресурсами, из одного места управлять не получится, задваивается/затраивается мониторинг систем и контуры резервного копирования;
- возникают проблемы миграции ресурсов между разными системами, усложняется распределение ресурсов;
- поддержка со стороны оборудования;
- проблемы автоматизации и инвентаризации, скрипты придётся адаптировать под каждую инфраструктуру


Как правило у инженера нет выбора по созданию среды  все решает существующая инфраструктура и бюджет. Например, если в организации существует разделение инфраструктуры по ИУСам, не вижу ничего плохого, в том, что, скажем, поисковый кластер Abbyy Intelligent Search будет развернут под Hyper-V на Windows, что ещё и обеспечит преимущество в производительности. В то же время развернуть ВКС типа Videomost на ресурсах esxi для меня не выглядит чем-то необычным.
В каком-то идеальном мире выбираем что-то одно исходя из задач и живём в этой инфраструктуре долго и счастливо, обучаем специалистов, заключаем контракты на поддержку… и штампуем типовые решения.





